import{a as j,u as h,c as m,j as e,f as p,d as y,D as N,Q as c,e as v,U as C,g as w,h as f,L as x,i as k,k as Q}from"./index-bc85fe3c.js";function I({item:t}){const o=j(),l=h();async function n(){if(t.count===1)return s();i(t.count-1)}const{mutate:s,isLoading:d}=m({mutationFn:()=>N(t.product.id),onSuccess:()=>{l.invalidateQueries({queryKey:["cart"]}),c.info("item was deleted")},onError:()=>{c.error("could not delete item")}}),{mutate:i,isLoading:r}=m({mutationFn:u=>v(u,t.product.id),onSuccess:()=>{l.invalidateQueries({queryKey:["cart"]})},onError:()=>{}});return e.jsxs("div",{className:" flex flex-row   justify-around items-center",children:[e.jsxs("div",{onClick:()=>o(`/productDetails/${t.product.id}`),className:"  items-center  cursor-pointer flex-wrap flex   md:gap-10",children:[e.jsx("img",{src:t.product.imageCover,width:250,height:250,className:"   w-24 h-28",alt:`${t.product.title}img`}),e.jsx("div",{className:"      md:w-36  ",children:e.jsx("h2",{children:t.product.title})})]}),e.jsxs("div",{className:" space-x-3   flex items-center",children:[e.jsx("button",{"aria-label":"decrease item by 1",disabled:r,onClick:n,className:`text-2xl font-semibold text-center ${r?"cursor-progress":""} bg-omar  pb-1  text-white w-10 h-10   disabled:opacity-50    rounded-full`,children:"-"}),e.jsx("span",{className:" font-semibold text-lg",children:t.count}),e.jsx("button",{"aria-label":"increase item by 1",disabled:r,onClick:()=>i(t.count+1),className:`text-2xl font-semibold text-center ${r?"cursor-progress":""} bg-omar  pb-1  text-white w-10 h-10   disabled:opacity-50    rounded-full`,children:"+"})]}),e.jsx("h3",{className:" text-omar font-bold",children:p(t.price*t.count)}),e.jsx("button",{"aria-label":"delete button",disabled:d,onClick:s,className:" text-red-600 disabled:opacity-50 text-3xl",children:e.jsx(y,{})})]})}const q="/assets/empty-cart.17f48bd13327a233e04a-e032299f.webp";function L(){const t=h(),{setCart:o,cart:l,user:n}=C(),{data:s,isLoading:d,isRefetching:i,refetch:r}=w({queryFn:k,queryKey:["cart",l]},{enabled:!!n});async function u(){try{return(await Q.delete("/api/v1/cart",{headers:{token:localStorage.getItem("token")}})).data}catch(a){throw console.log(a.data),a}}const{mutate:g}=m({mutationFn:u,onSuccess:()=>{t.cancelQueries({queryKey:["cart"]}),t.invalidateQueries(["cart"]),c.info("cart was cleared"),r(),o(a=>!a)},onError:()=>{c.error("could not clear cart"),t.invalidateQueries(["cart"])},onSettled:()=>{t.invalidateQueries(["cart"])},onMutate:()=>{t.invalidateQueries(["cart"])}});return d?e.jsx("div",{className:" flex items-center justify-center",children:e.jsx(f,{})}):i?e.jsx("div",{className:" flex items-center justify-center",children:e.jsx(f,{})}):n?s!=null&&s.numOfCartItems?e.jsxs("div",{className:" max-w-6xl flex-col flex   gap-6 mx-auto my-10",children:[s==null?void 0:s.data.products.map((a,b)=>e.jsx(I,{item:a},b)),e.jsxs("div",{className:" flex items-center justify-around my-5 gap-4",children:[e.jsxs("div",{className:" flex   items-center gap-4",children:[e.jsx("h2",{className:" font-bold text-lg",children:"Total Cart : "}),e.jsx("h3",{className:" text-omar font-bold text-lg",children:p(s==null?void 0:s.data.totalCartPrice)})]}),e.jsxs("div",{className:"   flex gap-2 ",children:[e.jsx("button",{onClick:g,className:" bg-red-600 text-center hover:bg-red-800  transition-all px-4 py-2  md:px-8 md:py-3 text-white font-semibold text-lg rounded-lg",children:"Clear Cart"}),e.jsx(x,{to:"/checkout",className:" hover:bg-black outline px-4 py-2 outline-black text-lg font-bold hover:text-white transition-all md:px-10 md:py-4 rounded-lg  text-black",children:"Check Out"})]})]})]}):e.jsxs("div",{className:" flex gap-2 flex-col items-center justify-center",children:[e.jsx("img",{src:q,alt:"empty cart img"}),e.jsx("h1",{className:" text-omar font-bold  text-3xl",children:"your cart is Empty"}),e.jsx(x,{className:" bg-black text-white px-6 py-2 rounded-xl my-4 font-semibold ",to:"/",children:"Keep Looking"})]}):e.jsxs("div",{className:" flex-col my-10 flex justify-center items-center",children:[e.jsx("h2",{className:"  text-3xl font-semibold",children:"You need to Sign in First"}),e.jsx(x,{className:" underline text-blue-600 text-2xl font-semibold",to:"/signin",children:"Sign in"})]})}export{L as default};
